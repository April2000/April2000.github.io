(function(s){s(jQuery)})(function(s){s.extend(s.FE.POPUP_TEMPLATES,{'image.insert':'[_BUTTONS_][_UPLOAD_LAYER_][_BY_URL_LAYER_][_PROGRESS_BAR_]','image.edit':'[_BUTTONS_]','image.alt':'[_BUTTONS_][_ALT_LAYER_]','image.size':'[_BUTTONS_][_SIZE_LAYER_]'}),s.extend(s.FE.DEFAULTS,{imageInsertButtons:['imageBack','|','imageUpload','imageByURL'],imageEditButtons:['imageReplace','imageAlign','imageRemove','|','imageLink','linkOpen','linkEdit','linkRemove','-','imageDisplay','imageStyle','imageAlt','imageSize'],imageAltButtons:['imageBack','|'],imageSizeButtons:['imageBack','|'],imageUploadURL:'https://i.froala.com/upload',imageUploadParam:'file',imageUploadParams:{},imageUploadToS3:!1,imageUploadMethod:'POST',imageMaxSize:10485760,imageAllowedTypes:['jpeg','jpg','png','gif','svg+xml'],imageResize:!0,imageResizeWithPercent:!1,imageRoundPercent:!1,imageDefaultWidth:300,imageDefaultAlign:'center',imageDefaultDisplay:'block',imageSplitHTML:!1,imageStyles:{'ft-rounded':'Rounded','fr-bordered':'Bordered'},imageMove:!0,imageMultipleStyles:!0,imageTextNear:!0,imagePaste:!0,imagePasteProcess:!1,imageMinWidth:16,imageOutputSize:!1,imageDefaultMargin:5}),s.FE.PLUGINS.image=function(o){function l(){var je=o.popups.get('image.insert'),Ve=je.find('.fr-image-by-url-layer input');Ve.val(''),Oe&&Ve.val(Oe.attr('src')),Ve.trigger('change')}function p(){var je=o.popups.get('image.edit');if(je||(je=A()),je){o.popups.setContainer('image.edit',o.$sc),o.popups.refresh('image.edit');var Ve=Oe.offset().left+Oe.outerWidth()/2,qe=Oe.offset().top+Oe.outerHeight();o.popups.show('image.edit',Ve,qe,Oe.outerHeight())}}function g(){D()}function f(je){je.hasClass('fr-dii')||je.hasClass('fr-dib')||(je.addClass('fr-fi'+Ee(je)[0]),je.addClass('fr-di'+Ce(je)[0]),je.css('margin',''),je.css('float',''),je.css('display',''),je.css('z-index',''),je.css('position',''),je.css('overflow',''),je.css('vertical-align',''))}function m(je){var Ve=je.hasClass('fr-dib')?'block':je.hasClass('fr-dii')?'inline':null,qe=je.hasClass('fr-fil')?'left':je.hasClass('fr-fir')?'right':Ee(je);be(je,Ve,qe),je.removeClass('fr-dib fr-dii fr-fir fr-fil')}function u(){for(var qe,je='IMG'==o.el.tagName?[o.el]:o.el.querySelectorAll('img'),Ve=0;Ve<je.length;Ve++)qe=s(je[Ve]),!o.opts.htmlUntouched&&o.opts.useClasses?((0<=o.opts.imageEditButtons.indexOf('imageAlign')||0<=o.opts.imageEditButtons.indexOf('imageDisplay'))&&f(qe),!o.opts.imageTextNear&&qe.removeClass('fr-dii').addClass('fr-dib')):!o.opts.htmlUntouched&&!o.opts.useClasses&&(0<=o.opts.imageEditButtons.indexOf('imageAlign')||0<=o.opts.imageEditButtons.indexOf('imageDisplay'))&&m(qe),o.opts.iframe&&qe.on('load',o.size.syncIframe)}function h(){var je=Array.prototype.slice.call(o.el.querySelectorAll('img')),Ve=[],qe;for(qe=0;qe<je.length;qe++)Ve.push(je[qe].getAttribute('src')),s(je[qe]).toggleClass('fr-draggable',o.opts.imageMove),''===je[qe].getAttribute('class')&&je[qe].removeAttribute('class'),''===je[qe].getAttribute('style')&&je[qe].removeAttribute('style');if(Ye)for(qe=0;qe<Ye.length;qe++)0>Ve.indexOf(Ye[qe].getAttribute('src'))&&o.events.trigger('image.removed',[s(Ye[qe])]);Ye=je}function v(){Fe||re();var je=o.$wp||o.$sc;je.append(Fe),Fe.data('instance',o);var Ve=je.scrollTop()-('static'==je.css('position')?0:je.offset().top),qe=je.scrollLeft()-('static'==je.css('position')?0:je.offset().left);qe-=o.helpers.getPX(je.css('border-left-width')),Ve-=o.helpers.getPX(je.css('border-top-width')),o.$el.is('img')&&(Ve=0,qe=0),Fe.css('top',(o.opts.iframe?Oe.offset().top:Oe.offset().top+Ve)-1).css('left',(o.opts.iframe?Oe.offset().left:Oe.offset().left+qe)-1).css('width',Oe.get(0).getBoundingClientRect().width).css('height',Oe.get(0).getBoundingClientRect().height).addClass('fr-active')}function b(je){return'<div class="fr-handler fr-h'+je+'"></div>'}function y(je){if(!o.core.sameInstance(Fe))return!0;if(je.preventDefault(),je.stopPropagation(),o.$el.find('img.fr-error').left)return!1;o.undo.canDo()||o.undo.saveStep(),Be=s(this),Be.data('start-x',je.pageX||je.originalEvent.touches[0].pageX),Be.data('start-width',Oe.width()),Be.data('start-height',Oe.height());var Ve=Oe.width();if(o.opts.imageResizeWithPercent){var qe=Oe.parentsUntil(o.$el,o.html.blockTagsQuery()).get(0)||o.el;Oe.css('width',(100*(Ve/s(qe).outerWidth())).toFixed(2)+'%')}else Oe.css('width',Ve);Ne.show(),o.popups.hideAll(),he()}function E(je){if(!o.core.sameInstance(Fe))return!0;if(Be&&Oe){if(je.preventDefault(),o.$el.find('img.fr-error').left)return!1;var Ve=je.pageX||(je.originalEvent.touches?je.originalEvent.touches[0].pageX:null);if(!Ve)return!1;var qe=Be.data('start-x'),Qe=Ve-qe,Ze=Be.data('start-width');if((Be.hasClass('fr-hnw')||Be.hasClass('fr-hsw'))&&(Qe=0-Qe),o.opts.imageResizeWithPercent){var Je=Oe.parentsUntil(o.$el,o.html.blockTagsQuery()).get(0)||o.el;Ze=(100*((Ze+Qe)/s(Je).outerWidth())).toFixed(2),o.opts.imageRoundPercent&&(Ze=Math.round(Ze)),Oe.css('width',Ze+'%'),Oe.css('height','').removeAttr('height')}else Ze+Qe>=o.opts.imageMinWidth&&Oe.css('width',Ze+Qe),Oe.css('height',Be.data('start-height')*Oe.width()/Be.data('start-width'));v(),o.events.trigger('image.resize',[$e()])}}function C(je){if(!o.core.sameInstance(Fe))return!0;if(Be&&Oe){if(je&&je.stopPropagation(),o.$el.find('img.fr-error').left)return!1;Be=null,Ne.hide(),v(),p(),o.undo.saveStep(),o.events.trigger('image.resizeEnd',[$e()])}}function w(je,Ve){o.edit.on(),Oe&&Oe.addClass('fr-error'),I(o.language.translate('Something went wrong. Please try again.')),o.events.trigger('image.error',[{code:je,message:He[je]},Ve])}function A(je){if(je)return o.$wp&&o.events.$on(o.$wp,'scroll',function(){Oe&&o.popups.isVisible('image.edit')&&(o.events.disableBlur(),x(Oe))}),!0;var Ve='';if(0<o.opts.imageEditButtons.length){Ve+='<div class="fr-buttons">',Ve+=o.button.buildList(o.opts.imageEditButtons),Ve+='</div>';var qe={buttons:Ve},Qe=o.popups.create('image.edit',qe);return Qe}return!1}function S(je){var Ve=o.popups.get('image.insert');if(Ve||(Ve=G()),Ve.find('.fr-layer.fr-active').removeClass('fr-active').addClass('fr-pactive'),Ve.find('.fr-image-progress-bar-layer').addClass('fr-active'),Ve.find('.fr-buttons').hide(),Oe){o.popups.setContainer('image.insert',o.$sc);var qe=Oe.offset().left+Oe.width()/2,Qe=Oe.offset().top+Oe.height();o.popups.show('image.insert',qe,Qe,Oe.outerHeight())}'undefined'==typeof je&&R('Uploading',0)}function D(je){var Ve=o.popups.get('image.insert');if(Ve&&(Ve.find('.fr-layer.fr-pactive').addClass('fr-active').removeClass('fr-pactive'),Ve.find('.fr-image-progress-bar-layer').removeClass('fr-active'),Ve.find('.fr-buttons').show(),je||o.$el.find('img.fr-error').length)){if(o.events.focus(),o.$el.find('img.fr-error').length&&(o.$el.find('img.fr-error').remove(),o.undo.saveStep(),o.undo.run(),o.undo.dropRedo()),!o.$wp&&Oe){var qe=Oe;ue(!0),o.selection.setAfter(qe.get(0)),o.selection.restore()}o.popups.hide('image.insert')}}function R(je,Ve){var qe=o.popups.get('image.insert');if(qe){var Qe=qe.find('.fr-image-progress-bar-layer');Qe.find('h3').text(je+(Ve?' '+Ve+'%':'')),Qe.removeClass('fr-error'),Ve?(Qe.find('div').removeClass('fr-indeterminate'),Qe.find('div > span').css('width',Ve+'%')):Qe.find('div').addClass('fr-indeterminate')}}function I(je){S();var Ve=o.popups.get('image.insert'),qe=Ve.find('.fr-image-progress-bar-layer');qe.addClass('fr-error');var Qe=qe.find('h3');Qe.text(je),o.events.disableBlur(),Qe.focus()}function x(je){me.call(je.get(0))}function U(){var je=s(this);o.popups.hide('image.insert'),je.removeClass('fr-uploading'),je.next().is('br')&&je.next().remove(),x(je),o.events.trigger('image.loaded',[je])}function O(je,Ve,qe,Qe,Ze){o.edit.off(),R('Loading image'),Ve&&(je=o.helpers.sanitizeURL(je));var Je=new Image;Je.onload=function(){var et,tt;if(Qe){o.undo.canDo()||Qe.hasClass('fr-uploading')||o.undo.saveStep();var at=Qe.data('fr-old-src');o.$wp?(et=Qe.clone().removeData('fr-old-src').removeClass('fr-uploading'),et.off('load'),at&&Qe.attr('src',at),Qe.replaceWith(et)):et=Qe;for(var rt,st=et.get(0).attributes,it=0;it<st.length;it++)rt=st[it],0===rt.nodeName.indexOf('data-')&&et.removeAttr(rt.nodeName);if('undefined'!=typeof qe)for(tt in qe)qe.hasOwnProperty(tt)&&'link'!=tt&&et.attr('data-'+tt,qe[tt]);et.on('load',U),et.attr('src',je),o.edit.on(),h(),o.undo.saveStep(),o.$el.blur(),o.events.trigger(at?'image.replaced':'image.inserted',[et,Ze])}else et=M(je,qe,U),h(),o.undo.saveStep(),o.events.trigger('image.inserted',[et,Ze])},Je.onerror=function(){w(Te)},S('Loading image'),Je.src=je}function F(je){try{if(!1===o.events.trigger('image.uploaded',[je],!0))return o.edit.on(),!1;var Ve=s.parseJSON(je);return Ve.link?Ve:(w(Me,je),!1)}catch(qe){return w(Le,je),!1}}function B(je){try{var Ve=s(je).find('Location').text(),qe=s(je).find('Key').text();return!1===o.events.trigger('image.uploadedToS3',[Ve,qe,je],!0)?(o.edit.on(),!1):Ve}catch(Qe){return w(Le,je),!1}}function N(je){R('Loading image');var Ve=this.status,qe=this.response,Qe=this.responseXML,Ze=this.responseText;try{if(o.opts.imageUploadToS3){if(201==Ve){var Je=B(Qe);Je&&O(Je,!1,[],je,qe||Qe)}else w(Le,qe||Qe);}else if(200<=Ve&&300>Ve){var et=F(Ze);et&&O(et.link,!1,et,je,qe||Ze)}else w(_e,qe||Ze)}catch(tt){w(Le,qe||Ze)}}function P(){w(Le,this.response||this.responseText||this.responseXML)}function T(je){if(je.lengthComputable){var Ve=0|100*(je.loaded/je.total);R('Uploading',Ve)}}function M(je,Ve,qe){var Ze,Qe='';if(Ve&&'undefined'!=typeof Ve)for(Ze in Ve)Ve.hasOwnProperty(Ze)&&'link'!=Ze&&(Qe+=' data-'+Ze+'="'+Ve[Ze]+'"');var Je=o.opts.imageDefaultWidth;Je&&'auto'!=Je&&(Je+=o.opts.imageResizeWithPercent?'%':'px');var et=s('<img src="'+je+'"'+Qe+(Je?' style="width: '+Je+';"':'')+'>');be(et,o.opts.imageDefaultDisplay,o.opts.imageDefaultAlign),et.on('load',qe),o.edit.on(),o.events.focus(!0),o.selection.restore(),o.undo.saveStep(),o.opts.imageSplitHTML?o.markers.split():o.markers.insert();var tt=o.$el.find('.fr-marker');return tt.replaceWith(et),o.html.wrap(),o.selection.clear(),et}function _(){o.edit.on(),D(!0)}function L(je,Ve,qe){function Qe(){var et=s(this);et.off('load'),et.addClass('fr-uploading'),et.next().is('br')&&et.next().remove(),o.placeholder.refresh(),et.is(Oe)||x(et),v(),S(),o.edit.off(),je.onload=function(){N.call(je,et)},je.onerror=P,je.upload.onprogress=T,je.onabort=_,et.off('abortUpload').on('abortUpload',function(){4!=je.readyState&&je.abort()}),je.send(Ve)}var Ze=new FileReader,Je;Ze.addEventListener('load',function(){var et=Ze.result;if(0>Ze.result.indexOf('svg+xml')){for(var tt=atob(Ze.result.split(',')[1]),at=[],st=0;st<tt.length;st++)at.push(tt.charCodeAt(st));et=window.URL.createObjectURL(new Blob([new Uint8Array(at)],{type:'image/jpeg'}))}Oe?(Oe.on('load',Qe),o.edit.on(),o.undo.saveStep(),Oe.data('fr-old-src',Oe.attr('src')),Oe.attr('src',et)):Je=M(et,null,Qe)},!1),Ze.readAsDataURL(qe)}function z(je){if('undefined'!=typeof je&&0<je.length){if(!1===o.events.trigger('image.beforeUpload',[je]))return!1;var Ve=je[0];if(Ve.size>o.opts.imageMaxSize)return w(ze),!1;if(0>o.opts.imageAllowedTypes.indexOf(Ve.type.replace(/image\//g,'')))return w(Ke),!1;var qe;if(o.drag_support.formdata&&(qe=o.drag_support.formdata?new FormData:null),qe){if(!1!==o.opts.imageUploadToS3)for(var Qe in qe.append('key',o.opts.imageUploadToS3.keyStart+new Date().getTime()+'-'+(Ve.name||'untitled')),qe.append('success_action_status','201'),qe.append('X-Requested-With','xhr'),qe.append('Content-Type',Ve.type),o.opts.imageUploadToS3.params)o.opts.imageUploadToS3.params.hasOwnProperty(Qe)&&qe.append(Qe,o.opts.imageUploadToS3.params[Qe]);for(Qe in o.opts.imageUploadParams)o.opts.imageUploadParams.hasOwnProperty(Qe)&&qe.append(Qe,o.opts.imageUploadParams[Qe]);qe.append(o.opts.imageUploadParam,Ve);var Ze=o.opts.imageUploadURL;o.opts.imageUploadToS3&&(o.opts.imageUploadToS3.uploadURL?Ze=o.opts.imageUploadToS3.uploadURL:Ze='https://'+o.opts.imageUploadToS3.region+'.amazonaws.com/'+o.opts.imageUploadToS3.bucket);var Je=o.core.getXHR(Ze,o.opts.imageUploadMethod);L(Je,qe,Ve)}}}function K(je){o.events.$on(je,'dragover dragenter','.fr-image-upload-layer',function(){return s(this).addClass('fr-drop'),!1}),o.events.$on(je,'dragleave dragend','.fr-image-upload-layer',function(){return s(this).removeClass('fr-drop'),!1}),o.events.$on(je,'drop','.fr-image-upload-layer',function(Ve){Ve.preventDefault(),Ve.stopPropagation(),s(this).removeClass('fr-drop');var qe=Ve.originalEvent.dataTransfer;if(qe&&qe.files){var Qe=je.data('instance')||o;Qe.events.disableBlur(),Qe.image.upload(qe.files),Qe.events.enableBlur()}}),o.events.$on(je,'change','.fr-image-upload-layer input[type="file"]',function(){if(this.files){var Ve=je.data('instance')||o;Ve.events.disableBlur(),je.find('input:focus').blur(),Ve.events.enableBlur(),Ve.image.upload(this.files)}s(this).val('')})}function W(je){var Ve=je.originalEvent.dataTransfer;if(Ve&&Ve.files&&Ve.files.length){var qe=Ve.files[0];if(qe&&qe.type&&0<=o.opts.imageAllowedTypes.indexOf(qe.type.replace(/image\//g,''))){o.markers.remove(),o.markers.insertAtPoint(je.originalEvent),o.$el.find('.fr-marker').replaceWith(s.FE.MARKERS),o.popups.hideAll();var Qe=o.popups.get('image.insert');return Qe||(Qe=G()),o.popups.setContainer('image.insert',o.$sc),o.popups.show('image.insert',je.originalEvent.pageX,je.originalEvent.pageY),S(),z(Ve.files),je.preventDefault(),je.stopPropagation(),!1}}}function H(){var je,Ve,qe=o.selection.ranges(0);qe.collapsed&&qe.startContainer.nodeType==Node.ELEMENT_NODE&&(qe.startContainer.childNodes.length==qe.startOffset?(je=qe.startContainer.childNodes[qe.startOffset-1],je&&'IMG'==je.tagName&&'block'==s(je).css('display')&&(Ve=o.node.blockParent(je),Ve&&o.html.defaultTag()?!Ve.nextSibling&&(0>['TD','TH'].indexOf(Ve.tagName)?s(Ve).after('<'+o.html.defaultTag()+'><br>'+s.FE.MARKERS+'</'+o.html.defaultTag()+'>'):s(je).after('<br>'+s.FE.MARKERS),o.selection.restore()):!Ve&&(s(je).after('<br>'+s.FE.MARKERS),o.selection.restore()))):0===qe.startOffset&&qe.startContainer.childNodes.length>qe.startOffset&&(je=qe.startContainer.childNodes[qe.startOffset],je&&'IMG'==je.tagName&&'block'==s(je).css('display')&&(Ve=o.node.blockParent(je),Ve&&o.html.defaultTag()?!Ve.previousSibling&&(0>['TD','TH'].indexOf(Ve.tagName)?s(Ve).before('<'+o.html.defaultTag()+'><br>'+s.FE.MARKERS+'</'+o.html.defaultTag()+'>'):s(je).before('<br>'+s.FE.MARKERS),o.selection.restore()):!Ve&&(s(je).before(s.FE.MARKERS+'<br>'),o.selection.restore()))))}function Y(){o.events.$on(o.$el,o._mousedown,'IMG'==o.el.tagName?null:'img:not([contenteditable="false"])',function(je){return!('false'!=s(this).parents('[contenteditable]:not(.fr-element):not(body):first').attr('contenteditable'))||void(!o.helpers.isMobile()&&o.selection.clear(),Pe=!0,o.popups.areVisible()&&o.events.disableBlur(),o.browser.msie&&(o.events.disableBlur(),o.$el.attr('contenteditable',!1)),!o.draggable&&je.preventDefault(),je.stopPropagation())}),o.events.$on(o.$el,o._mouseup,'IMG'==o.el.tagName?null:'img:not([contenteditable="false"])',function(je){return!('false'!=s(this).parents('[contenteditable]:not(.fr-element):not(body):first').attr('contenteditable'))||void(Pe&&(Pe=!1,je.stopPropagation(),o.browser.msie&&(o.$el.attr('contenteditable',!0),o.events.enableBlur())))}),o.events.on('keyup',function(je){if(je.shiftKey&&''===o.selection.text().replace(/\n/g,'')){var Ve=o.selection.element(),qe=o.selection.endElement();Ve&&'IMG'==Ve.tagName?x(s(Ve)):qe&&'IMG'==qe.tagName&&x(s(qe))}},!0),o.events.on('drop',W),o.events.on('mousedown window.mousedown',ce),o.events.on('window.touchmove',he),o.events.on('mouseup window.mouseup',function(){return Oe?(ue(),!1):void he()}),o.events.on('commands.mousedown',function(je){0<je.parents('.fr-toolbar').length&&ue()}),o.browser.edge||o.events.on('mouseup',H),o.events.on('blur image.hideResizer commands.undo commands.redo element.dropped',function(){Pe=!1,ue(!0)})}function G(je){if(je)return o.popups.onRefresh('image.insert',l),o.popups.onHide('image.insert',g),!0;var Ve,qe='';1<o.opts.imageInsertButtons.length&&(qe='<div class="fr-buttons">'+o.button.buildList(o.opts.imageInsertButtons)+'</div>');var Qe=o.opts.imageInsertButtons.indexOf('imageUpload'),Ze=o.opts.imageInsertButtons.indexOf('imageByURL'),Je='';0<=Qe&&(Ve=' fr-active',0<=Ze&&Qe>Ze&&(Ve=''),Je='<div class="fr-image-upload-layer'+Ve+' fr-layer" id="fr-image-upload-layer-'+o.id+'"><strong>'+o.language.translate('Drop image')+'</strong><br>('+o.language.translate('or click')+')<div class="fr-form"><input type="file" accept="image/'+o.opts.imageAllowedTypes.join(', image/').toLowerCase()+'" tabIndex="-1" aria-labelledby="fr-image-upload-layer-'+o.id+'" role="button"></div></div>');var et='';0<=Ze&&(Ve=' fr-active',0<=Qe&&Ze>Qe&&(Ve=''),et='<div class="fr-image-by-url-layer'+Ve+' fr-layer" id="fr-image-by-url-layer-'+o.id+'"><div class="fr-input-line"><input id="fr-image-by-url-layer-text-'+o.id+'" type="text" placeholder="http://" tabIndex="1" aria-required="true"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageInsertByURL" tabIndex="2" role="button">'+o.language.translate('Insert')+'</button></div></div>');var at={buttons:qe,upload_layer:Je,by_url_layer:et,progress_bar:'<div class="fr-image-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading</h3><div class="fr-loader"><span class="fr-progress"></span></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="imageDismissError" tabIndex="2" role="button">OK</button></div></div>'},st=o.popups.create('image.insert',at);return o.$wp&&o.events.$on(o.$wp,'scroll',function(){Oe&&o.popups.isVisible('image.insert')&&Ie()}),K(st),st}function X(){if(Oe){var je=o.popups.get('image.alt');je.find('input').val(Oe.attr('alt')||'').trigger('change')}}function j(){var je=o.popups.get('image.alt');je||(je=V()),D(),o.popups.refresh('image.alt'),o.popups.setContainer('image.alt',o.$sc);var Ve=Oe.offset().left+Oe.width()/2,qe=Oe.offset().top+Oe.height();o.popups.show('image.alt',Ve,qe,Oe.outerHeight())}function V(je){if(je)return o.popups.onRefresh('image.alt',X),!0;var Ve='';Ve='<div class="fr-buttons">'+o.button.buildList(o.opts.imageAltButtons)+'</div>';var qe='';qe='<div class="fr-image-alt-layer fr-layer fr-active" id="fr-image-alt-layer-'+o.id+'"><div class="fr-input-line"><input id="fr-image-alt-layer-text-'+o.id+'" type="text" placeholder="'+o.language.translate('Alternate Text')+'" tabIndex="1"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetAlt" tabIndex="2" role="button">'+o.language.translate('Update')+'</button></div></div>';var Qe={buttons:Ve,alt_layer:qe},Ze=o.popups.create('image.alt',Qe);return o.$wp&&o.events.$on(o.$wp,'scroll.image-alt',function(){Oe&&o.popups.isVisible('image.alt')&&j()}),Ze}function Q(){if(Oe){var je=o.popups.get('image.size');je.find('input[name="width"]').val(Oe.get(0).style.width).trigger('change'),je.find('input[name="height"]').val(Oe.get(0).style.height).trigger('change')}}function Z(){var je=o.popups.get('image.size');je||(je=J()),D(),o.popups.refresh('image.size'),o.popups.setContainer('image.size',o.$sc);var Ve=Oe.offset().left+Oe.width()/2,qe=Oe.offset().top+Oe.height();o.popups.show('image.size',Ve,qe,Oe.outerHeight())}function J(je){if(je)return o.popups.onRefresh('image.size',Q),!0;var Ve='';Ve='<div class="fr-buttons">'+o.button.buildList(o.opts.imageSizeButtons)+'</div>';var qe='';qe='<div class="fr-image-size-layer fr-layer fr-active" id="fr-image-size-layer-'+o.id+'"><div class="fr-image-group"><div class="fr-input-line"><input id="fr-image-size-layer-width-'+o.id+'" type="text" name="width" placeholder="'+o.language.translate('Width')+'" tabIndex="1"></div><div class="fr-input-line"><input id="fr-image-size-layer-height'+o.id+'" type="text" name="height" placeholder="'+o.language.translate('Height')+'" tabIndex="1"></div></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetSize" tabIndex="2" role="button">'+o.language.translate('Update')+'</button></div></div>';var Qe={buttons:Ve,size_layer:qe},Ze=o.popups.create('image.size',Qe);return o.$wp&&o.events.$on(o.$wp,'scroll.image-size',function(){Oe&&o.popups.isVisible('image.size')&&Z()}),Ze}function ie(je,Ve,qe,Qe){return je.pageX=Ve,y.call(this,je),je.pageX+=qe*Math.floor(Math.pow(1.1,Qe)),E.call(this,je),C.call(this,je),++Qe}function re(){var je;if(o.shared.$image_resizer?(Fe=o.shared.$image_resizer,Ne=o.shared.$img_overlay,o.events.on('destroy',function(){Fe.removeClass('fr-active').appendTo(s('body'))},!0)):(o.shared.$image_resizer=s('<div class="fr-image-resizer"></div>'),Fe=o.shared.$image_resizer,o.events.$on(Fe,'mousedown',function(Ze){Ze.stopPropagation()},!0),o.opts.imageResize&&(Fe.append(b('nw')+b('ne')+b('sw')+b('se')),o.shared.$img_overlay=s('<div class="fr-image-overlay"></div>'),Ne=o.shared.$img_overlay,o.$sc.append(Ne))),o.events.on('shared.destroy',function(){Fe.html('').removeData().remove(),Fe=null,o.opts.imageResize&&(Ne.remove(),Ne=null)},!0),o.helpers.isMobile()||o.events.$on(s(o.o_win),'resize',function(){Oe&&!Oe.hasClass('fr-uploading')?ue(!0):Oe&&(v(),Ie(),S(!1))}),o.opts.imageResize){je=o.$sc.get(0).ownerDocument,o.events.$on(Fe,o._mousedown,'.fr-handler',y),o.events.$on(s(je),o._mousemove,E),o.events.$on(s(je.defaultView||je.parentWindow),o._mouseup,C),o.events.$on(Ne,'mouseleave',C);var Ve=1,qe=null,Qe=0;o.events.on('keydown',function(Ze){if(Oe){var Je=-1==navigator.userAgent.indexOf('Mac OS X')?Ze.ctrlKey:Ze.metaKey,et=Ze.which;(et!==qe||200<Ze.timeStamp-Qe)&&(Ve=1),(et==s.FE.KEYCODE.EQUALS||o.browser.mozilla&&et==s.FE.KEYCODE.FF_EQUALS)&&Je&&!Ze.altKey?Ve=ie.call(this,Ze,1,1,Ve):(et==s.FE.KEYCODE.HYPHEN||o.browser.mozilla&&et==s.FE.KEYCODE.FF_HYPHEN)&&Je&&!Ze.altKey?Ve=ie.call(this,Ze,2,-1,Ve):!o.keys.ctrlKey(Ze)&&et==s.FE.KEYCODE.ENTER&&(Oe.before('<br>'),x(Oe)),qe=et,Qe=Ze.timeStamp}},!0),o.events.on('keyup',function(){Ve=1})}}function oe(je){je=je||Oe,je&&!1!==o.events.trigger('image.beforeRemove',[je])&&(o.popups.hideAll(),ke(),ue(!0),!o.undo.canDo()&&o.undo.saveStep(),je.get(0)==o.el?je.removeAttr('src'):('A'==je.get(0).parentNode.tagName?(o.selection.setBefore(je.get(0).parentNode)||o.selection.setAfter(je.get(0).parentNode)||je.parent().after(s.FE.MARKERS),s(je.get(0).parentNode).remove()):(o.selection.setBefore(je.get(0))||o.selection.setAfter(je.get(0))||je.after(s.FE.MARKERS),je.remove()),o.html.fillEmptyBlocks(),o.selection.restore()),o.undo.saveStep())}function le(je){var Ve=je.which;if(Oe&&(Ve==s.FE.KEYCODE.BACKSPACE||Ve==s.FE.KEYCODE.DELETE))return je.preventDefault(),je.stopPropagation(),oe(),!1;if(Oe&&Ve==s.FE.KEYCODE.ESC){var qe=Oe;return ue(!0),o.selection.setAfter(qe.get(0)),o.selection.restore(),je.preventDefault(),!1}if(Oe&&(Ve==s.FE.KEYCODE.ARROW_LEFT||Ve==s.FE.KEYCODE.ARROW_RIGHT)){var Qe=Oe.get(0);return ue(!0),Ve==s.FE.KEYCODE.ARROW_LEFT?o.selection.setBefore(Qe):o.selection.setAfter(Qe),o.selection.restore(),je.preventDefault(),!1}return Oe&&Ve!=s.FE.KEYCODE.F10&&!o.keys.isBrowserAction(je)?(je.preventDefault(),je.stopPropagation(),!1):void 0}function ne(je){if(je&&'IMG'==je.tagName)o.node.hasClass(je,'fr-uploading')||o.node.hasClass(je,'fr-error')?je.parentNode.removeChild(je):o.node.hasClass(je,'fr-draggable')&&je.classList.remove('fr-draggable');else if(je&&je.nodeType==Node.ELEMENT_NODE)for(var Ve=je.querySelectorAll('img.fr-uploading, img.fr-error, img.fr-draggable'),qe=0;qe<Ve.length;qe++)ne(Ve[qe])}function pe(){o.opts.imagePaste?o.$el.find('img[data-fr-image-pasted]').each(function(je,Ve){if(o.opts.imagePasteProcess){var qe=o.opts.imageDefaultWidth;qe&&'auto'!=qe&&(qe+=o.opts.imageResizeWithPercent?'%':'px'),s(Ve).css('width',qe),s(Ve).removeClass('fr-dii fr-dib fr-fir fr-fil').addClass((o.opts.imageDefaultDisplay?'fr-di'+o.opts.imageDefaultDisplay[0]:'')+(o.opts.imageDefaultAlign?'center'==o.opts.imageDefaultAlign?'':' fr-fi'+o.opts.imageDefaultAlign[0]:''))}if(0===Ve.src.indexOf('data:')){if(!1===o.events.trigger('image.beforePasteUpload',[Ve]))return!1;Oe=s(Ve),v(),p(),Ie(),S(),o.edit.off();for(var Qe=atob(s(Ve).attr('src').split(',')[1]),Ze=[],Je=0;Je<Qe.length;Je++)Ze.push(Qe.charCodeAt(Je));var et=new Blob([new Uint8Array(Ze)],{type:'image/jpeg'});z([et]),s(Ve).removeAttr('data-fr-image-pasted')}else 0!==Ve.src.indexOf('http')||0===Ve.src.indexOf('https://mail.google.com/mail')?(o.selection.save(),s(Ve).remove(),o.selection.restore()):s(Ve).removeAttr('data-fr-image-pasted')}):o.$el.find('img[data-fr-image-pasted]').remove()}function ge(je){if(je&&je.clipboardData&&je.clipboardData.items&&je.clipboardData.items[0]){var Ve=je.clipboardData.items[0].getAsFile();if(Ve){var qe=new FileReader;return qe.onload=function(Qe){var Ze=Qe.target.result,Je=o.opts.imageDefaultWidth;Je&&'auto'!=Je&&(Je+=o.opts.imageResizeWithPercent?'%':'px'),o.html.insert('<img data-fr-image-pasted="true" class="'+(o.opts.imageDefaultDisplay?'fr-di'+o.opts.imageDefaultDisplay[0]:'')+(o.opts.imageDefaultAlign?'center'==o.opts.imageDefaultAlign?'':' fr-fi'+o.opts.imageDefaultAlign[0]:'')+'" src="'+Ze+'"'+(Je?' style="width: '+Je+';"':'')+'>'),o.events.trigger('paste.after')},qe.readAsDataURL(Ve),!1}}}function fe(je){return je=je.replace(/<img /gi,'<img data-fr-image-pasted="true" '),je}function me(je){if('false'==s(this).parents('[contenteditable]:not(.fr-element):not(body):first').attr('contenteditable'))return!0;if(je&&'touchend'==je.type&&Ge)return!0;if(je&&o.edit.isDisabled())return je.stopPropagation(),je.preventDefault(),!1;for(var Ve=0;Ve<s.FE.INSTANCES.length;Ve++)s.FE.INSTANCES[Ve]!=o&&s.FE.INSTANCES[Ve].events.trigger('image.hideResizer');o.toolbar.disable(),je&&(je.stopPropagation(),je.preventDefault()),o.helpers.isMobile()&&(o.events.disableBlur(),o.$el.blur(),o.events.enableBlur()),o.opts.iframe&&o.size.syncIframe(),Oe=s(this),ke(),v(),p(),o.selection.clear(),o.button.bulkRefresh(),o.events.trigger('video.hideResizer')}function ue(je){Oe&&(ve()||!0===je)&&(o.toolbar.enable(),Fe.removeClass('fr-active'),o.popups.hide('image.edit'),Oe=null,he())}function ce(){Xe=!0}function he(){Xe=!1}function ve(){return Xe}function be(je,Ve,qe){!o.opts.htmlUntouched&&o.opts.useClasses?(je.removeClass('fr-fil fr-fir fr-dib fr-dii'),je.addClass('fr-fi'+qe[0]+' fr-di'+Ve[0])):'inline'==Ve?(je.css({display:'inline-block',verticalAlign:'bottom',margin:o.opts.imageDefaultMargin}),'center'==qe?je.css({float:'none',marginBottom:'',marginTop:'',maxWidth:'calc(100% - '+2*o.opts.imageDefaultMargin+'px)'}):'left'==qe?je.css({float:'left',marginLeft:0,maxWidth:'calc(100% - '+o.opts.imageDefaultMargin+'px)'}):je.css({float:'right',marginRight:0,maxWidth:'calc(100% - '+o.opts.imageDefaultMargin+'px)'})):'block'==Ve&&(je.css({display:'block',float:'none',verticalAlign:'top',margin:o.opts.imageDefaultMargin+'px auto'}),'left'==qe?je.css({marginLeft:0}):'right'==qe&&je.css({marginRight:0}))}function Ee(je){if('undefined'==typeof je&&(je=Oe),je){if(je.hasClass('fr-fil'))return'left';if(je.hasClass('fr-fir'))return'right';if(je.hasClass('fr-dib')||je.hasClass('fr-dii'))return'center';var Ve=je.css('float');if(je.css('float','none'),'block'==je.css('display')){if(je.css('float',''),je.css('float')!=Ve&&je.css('float',Ve),0===parseInt(je.css('margin-left'),10))return'left';if(0===parseInt(je.css('margin-right'),10))return'right'}else{if(je.css('float',''),je.css('float')!=Ve&&je.css('float',Ve),'left'==je.css('float'))return'left';if('right'==je.css('float'))return'right'}}return'center'}function Ce(je){'undefined'==typeof je&&(je=Oe);var Ve=je.css('float');return je.css('float','none'),'block'==je.css('display')?(je.css('float',''),je.css('float')!=Ve&&je.css('float',Ve),'block'):(je.css('float',''),je.css('float')!=Ve&&je.css('float',Ve),'inline')}function Ie(){var je=o.popups.get('image.insert');je||(je=G()),o.popups.isVisible('image.insert')||(D(),o.popups.refresh('image.insert'),o.popups.setContainer('image.insert',o.$sc));var Ve=Oe.offset().left+Oe.width()/2,qe=Oe.offset().top+Oe.height();o.popups.show('image.insert',Ve,qe,Oe.outerHeight())}function ke(){if(Oe){o.selection.clear();var je=o.doc.createRange();je.selectNode(Oe.get(0));var Ve=o.selection.get();Ve.addRange(je)}}function $e(){return Oe}var Oe,Fe,Be,Ne,Pe=!1,Te=1,Me=2,_e=3,Le=4,ze=5,Ke=6,He={};He[Te]='Image cannot be loaded from the passed link.',He[Me]='No link in upload response.',He[_e]='Error during file upload.',He[Le]='Parsing response failed.',He[ze]='File is too large.',He[Ke]='Image file type is invalid.',He[7]='Files can be uploaded only to same domain in IE 8 and IE 9.';var Ye,Ge,Xe=!1;return{_init:function(){if(Y(),'IMG'==o.el.tagName&&o.$el.addClass('fr-view'),o.events.$on(o.$el,o.helpers.isMobile()&&!o.helpers.isWindowsPhone()?'touchend':'click','IMG'==o.el.tagName?null:'img:not([contenteditable="false"])',me),o.helpers.isMobile()&&(o.events.$on(o.$el,'touchstart','IMG'==o.el.tagName?null:'img:not([contenteditable="false"])',function(){Ge=!1}),o.events.$on(o.$el,'touchmove',function(){Ge=!0})),o.$wp?(o.events.on('window.keydown keydown',le,!0),o.events.on('keyup',function(Ve){if(Ve.which==s.FE.KEYCODE.ENTER)return!1},!0)):o.events.$on(o.$win,'keydown',le),o.events.on('toolbar.esc',function(){if(Oe){if(o.$wp)o.events.disableBlur(),o.events.focus();else{var Ve=Oe;ue(!0),o.selection.setAfter(Ve.get(0)),o.selection.restore()}return!1}},!0),o.events.on('toolbar.focusEditor',function(){if(Oe)return!1},!0),o.events.on('window.cut window.copy',function(Ve){Oe&&o.popups.isVisible('image.edit')&&!o.popups.get('image.edit').find(':focus').length&&(ke(),s.FE.copied_text='\n',s.FE.copied_html=Oe.get(0).outerHTML,'copy'==Ve.type?setTimeout(function(){x(Oe)}):(ue(!0),o.undo.saveStep(),setTimeout(function(){o.undo.saveStep()},0)))},!0),o.events.$on(s(o.o_win),'keydown',function(Ve){var qe=Ve.which;if(Oe&&qe==s.FE.KEYCODE.BACKSPACE)return Ve.preventDefault(),!1}),o.events.$on(o.$win,'keydown',function(Ve){var qe=Ve.which;Oe&&Oe.hasClass('fr-uploading')&&qe==s.FE.KEYCODE.ESC&&Oe.trigger('abortUpload')}),o.events.on('destroy',function(){Oe&&Oe.hasClass('fr-uploading')&&Oe.trigger('abortUpload')}),o.events.on('paste.before',ge),o.events.on('paste.beforeCleanup',fe),o.events.on('paste.after',pe),o.events.on('html.set',u),o.events.on('html.inserted',u),u(),o.events.on('destroy',function(){Ye=[]}),o.events.on('html.processGet',ne),o.opts.imageOutputSize){var je;o.events.on('html.beforeGet',function(){je=o.el.querySelectorAll('img');for(var Ve=0;Ve<je.length;Ve++){var qe=je[Ve].style.width||s(je[Ve]).width(),Qe=je[Ve].style.height||s(je[Ve]).height();qe&&je[Ve].setAttribute('width',(''+qe).replace(/px/,'')),Qe&&je[Ve].setAttribute('height',(''+Qe).replace(/px/,''))}}),o.events.on('html.afterGet',function(){for(var Ve=0;Ve<je.length;Ve++)je[Ve].removeAttribute('width'),je[Ve].removeAttribute('height')})}o.opts.iframe&&o.events.on('image.loaded',o.size.syncIframe),o.$wp&&(h(),o.events.on('contentChanged',h)),o.events.$on(s(o.o_win),'orientationchange.image',function(){setTimeout(function(){Oe&&x(Oe)},100)}),A(!0),G(!0),J(!0),V(!0),o.events.on('node.remove',function(Ve){if('IMG'==Ve.get(0).tagName)return oe(Ve),!1})},showInsertPopup:function(){var je=o.$tb.find('.fr-command[data-cmd="insertImage"]'),Ve=o.popups.get('image.insert');if(Ve||(Ve=G()),D(),!Ve.hasClass('fr-active'))if(o.popups.refresh('image.insert'),o.popups.setContainer('image.insert',o.$tb),je.is(':visible')){var qe=je.offset().left+je.outerWidth()/2,Qe=je.offset().top+(o.opts.toolbarBottom?10:je.outerHeight()-10);o.popups.show('image.insert',qe,Qe,je.outerHeight())}else o.position.forSelection(Ve),o.popups.show('image.insert')},showLayer:function(je){var Ve=o.popups.get('image.insert'),qe,Qe;if(!Oe&&!o.opts.toolbarInline){var Ze=o.$tb.find('.fr-command[data-cmd="insertImage"]');qe=Ze.offset().left+Ze.outerWidth()/2,Qe=Ze.offset().top+(o.opts.toolbarBottom?10:Ze.outerHeight()-10)}else Oe&&(Qe=Oe.offset().top+Oe.outerHeight());!Oe&&o.opts.toolbarInline&&(Qe=Ve.offset().top-o.helpers.getPX(Ve.css('margin-top')),Ve.hasClass('fr-above')&&(Qe+=Ve.outerHeight())),Ve.find('.fr-layer').removeClass('fr-active'),Ve.find('.fr-'+je+'-layer').addClass('fr-active'),o.popups.show('image.insert',qe,Qe,Oe?Oe.outerHeight():0),o.accessibility.focusPopup(Ve)},refreshUploadButton:function(je){var Ve=o.popups.get('image.insert');Ve.find('.fr-image-upload-layer').hasClass('fr-active')&&je.addClass('fr-active').attr('aria-pressed',!0)},refreshByURLButton:function(je){var Ve=o.popups.get('image.insert');Ve.find('.fr-image-by-url-layer').hasClass('fr-active')&&je.addClass('fr-active').attr('aria-pressed',!0)},upload:z,insertByURL:function(){var je=o.popups.get('image.insert'),Ve=je.find('.fr-image-by-url-layer input');0<Ve.val().length&&(S(),R('Loading image'),O(Ve.val(),!0,[],Oe),Ve.val(''),Ve.blur())},align:function(je){Oe.removeClass('fr-fir fr-fil'),!o.opts.htmlUntouched&&o.opts.useClasses?'left'==je?Oe.addClass('fr-fil'):'right'==je&&Oe.addClass('fr-fir'):be(Oe,Ce(),je),v(),p()},refreshAlign:function(je){Oe&&je.find('> *:first').replaceWith(o.icon.create('image-align-'+Ee()))},refreshAlignOnShow:function(je,Ve){Oe&&Ve.find('.fr-command[data-param1="'+Ee()+'"]').addClass('fr-active').attr('aria-selected',!0)},refreshDisplay:function(je){Oe.hasClass('fr-dii')?je.find('> *:first').replaceWith(o.icon.create('imageDisplay-inline')):je.find('> *:first').replaceWith(o.icon.create('imageDisplay-block'))},display:function(je){Oe.removeClass('fr-dii fr-dib'),!o.opts.htmlUntouched&&o.opts.useClasses?'inline'==je?Oe.addClass('fr-dii'):'block'==je&&Oe.addClass('fr-dib'):be(Oe,je,Ee()),v(),p()},refreshDisplayOnShow:function(je,Ve){Oe&&Ve.find('.fr-command[data-param1="'+Ce()+'"]').addClass('fr-active').attr('aria-selected',!0)},replace:Ie,back:function(){Oe?(o.events.disableBlur(),s('.fr-popup input:focus').blur(),x(Oe)):(o.events.disableBlur(),o.selection.restore(),o.events.enableBlur(),o.popups.hide('image.insert'),o.toolbar.showInline())},get:$e,insert:O,showProgressBar:S,remove:oe,hideProgressBar:D,applyStyle:function(je,Ve,qe){if('undefined'==typeof Ve&&(Ve=o.opts.imageStyles),'undefined'==typeof qe&&(qe=o.opts.imageMultipleStyles),!Oe)return!1;if(!qe){var Qe=Object.keys(Ve);Qe.splice(Qe.indexOf(je),1),Oe.removeClass(Qe.join(' '))}'object'==typeof Ve[je]?(Oe.removeAttr('style'),Oe.css(Ve[je].style)):Oe.toggleClass(je),x(Oe)},showAltPopup:j,showSizePopup:Z,setAlt:function(je){if(Oe){var Ve=o.popups.get('image.alt');Oe.attr('alt',je||Ve.find('input').val()||''),Ve.find('input:focus').blur(),x(Oe)}},setSize:function(je,Ve){if(Oe){var qe=o.popups.get('image.size');je=je||qe.find('input[name="width"]').val()||'',Ve=Ve||qe.find('input[name="height"]').val()||'';var Qe=/^[\d]+((px)|%)*$/g;je.match(Qe)&&Oe.css('width',je),Ve.match(Qe)&&Oe.css('height',Ve),qe.find('input:focus').blur(),x(Oe)}},exitEdit:ue,edit:x}},s.FE.DefineIcon('insertImage',{NAME:'image'}),s.FE.RegisterShortcut(s.FE.KEYCODE.P,'insertImage',null,'P'),s.FE.RegisterCommand('insertImage',{title:'Insert Image',undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible('image.insert')?(this.$el.find('.fr-marker').length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide('image.insert')):this.image.showInsertPopup()},plugin:'image'}),s.FE.DefineIcon('imageUpload',{NAME:'upload'}),s.FE.RegisterCommand('imageUpload',{title:'Upload Image',undo:!1,focus:!1,toggle:!0,callback:function(){this.image.showLayer('image-upload')},refresh:function(o){this.image.refreshUploadButton(o)}}),s.FE.DefineIcon('imageByURL',{NAME:'link'}),s.FE.RegisterCommand('imageByURL',{title:'By URL',undo:!1,focus:!1,toggle:!0,callback:function(){this.image.showLayer('image-by-url')},refresh:function(o){this.image.refreshByURLButton(o)}}),s.FE.RegisterCommand('imageInsertByURL',{title:'Insert Image',undo:!0,refreshAfterCallback:!1,callback:function(){this.image.insertByURL()},refresh:function(o){var l=this.image.get();l?o.text(this.language.translate('Replace')):o.text(this.language.translate('Insert'))}}),s.FE.DefineIcon('imageDisplay',{NAME:'star'}),s.FE.RegisterCommand('imageDisplay',{title:'Display',type:'dropdown',options:{inline:'Inline',block:'Break Text'},html:function(){var o='<ul class="fr-dropdown-list" role="presentation">',l=s.FE.COMMANDS.imageDisplay.options;for(var n in l)l.hasOwnProperty(n)&&(o+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="imageDisplay" data-param1="'+n+'" title="'+this.language.translate(l[n])+'">'+this.icon.create('imageDisplay-'+n)+'<span class="fr-sr-only">'+this.language.translate(l[n])+'</span></a></li>');return o+='</ul>',o},callback:function(o,l){this.image.display(l)},refresh:function(o){this.opts.imageTextNear||o.addClass('fr-hidden'),this.image.refreshDisplay(o)},refreshOnShow:function(o,l){this.image.refreshDisplayOnShow(o,l)}}),s.FE.DefineIcon('image-align',{NAME:'align-left'}),s.FE.DefineIcon('image-align-left',{NAME:'align-left'}),s.FE.DefineIcon('image-align-right',{NAME:'align-right'}),s.FE.DefineIcon('image-align-center',{NAME:'align-justify'}),s.FE.DefineIcon('imageAlign',{NAME:'align-justify'}),s.FE.RegisterCommand('imageAlign',{type:'dropdown',title:'Align',options:{left:'Align Left',center:'None',right:'Align Right'},html:function(){var o='<ul class="fr-dropdown-list" role="presentation">',l=s.FE.COMMANDS.imageAlign.options;for(var n in l)l.hasOwnProperty(n)&&(o+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="imageAlign" data-param1="'+n+'" title="'+this.language.translate(l[n])+'">'+this.icon.create('image-align-'+n)+'<span class="fr-sr-only">'+this.language.translate(l[n])+'</span></a></li>');return o+='</ul>',o},callback:function(o,l){this.image.align(l)},refresh:function(o){this.image.refreshAlign(o)},refreshOnShow:function(o,l){this.image.refreshAlignOnShow(o,l)}}),s.FE.DefineIcon('imageReplace',{NAME:'exchange'}),s.FE.RegisterCommand('imageReplace',{title:'Replace',undo:!1,focus:!1,popup:!0,refreshAfterCallback:!1,callback:function(){this.image.replace()}}),s.FE.DefineIcon('imageRemove',{NAME:'trash'}),s.FE.RegisterCommand('imageRemove',{title:'Remove',callback:function(){this.image.remove()}}),s.FE.DefineIcon('imageBack',{NAME:'arrow-left'}),s.FE.RegisterCommand('imageBack',{title:'Back',undo:!1,focus:!1,back:!0,callback:function(){this.image.back()},refresh:function(o){var l=this.image.get();l||this.opts.toolbarInline?(o.removeClass('fr-hidden'),o.next('.fr-separator').removeClass('fr-hidden')):(o.addClass('fr-hidden'),o.next('.fr-separator').addClass('fr-hidden'))}}),s.FE.RegisterCommand('imageDismissError',{title:'OK',undo:!1,callback:function(){this.image.hideProgressBar(!0)}}),s.FE.DefineIcon('imageStyle',{NAME:'magic'}),s.FE.RegisterCommand('imageStyle',{title:'Style',type:'dropdown',html:function(){var o='<ul class="fr-dropdown-list" role="presentation">',l=this.opts.imageStyles;for(var n in l)if(l.hasOwnProperty(n)){var p=l[n];'object'==typeof p&&(p=p.title),o+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="imageStyle" data-param1="'+n+'">'+this.language.translate(p)+'</a></li>'}return o+='</ul>',o},callback:function(o,l){this.image.applyStyle(l)},refreshOnShow:function(o,l){var n=this.image.get();n&&l.find('.fr-command').each(function(){var p=s(this).data('param1'),g=n.hasClass(p);s(this).toggleClass('fr-active',g).attr('aria-selected',g)})}}),s.FE.DefineIcon('imageAlt',{NAME:'info'}),s.FE.RegisterCommand('imageAlt',{undo:!1,focus:!1,popup:!0,title:'Alternate Text',callback:function(){this.image.showAltPopup()}}),s.FE.RegisterCommand('imageSetAlt',{undo:!0,focus:!1,title:'Update',refreshAfterCallback:!1,callback:function(){this.image.setAlt()}}),s.FE.DefineIcon('imageSize',{NAME:'arrows-alt'}),s.FE.RegisterCommand('imageSize',{undo:!1,focus:!1,popup:!0,title:'Change Size',callback:function(){this.image.showSizePopup()}}),s.FE.RegisterCommand('imageSetSize',{undo:!0,focus:!1,title:'Update',refreshAfterCallback:!1,callback:function(){this.image.setSize()}})});