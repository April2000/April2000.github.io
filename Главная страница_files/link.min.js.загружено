(function(a){a(jQuery)})(function(a){a.extend(a.FE.POPUP_TEMPLATES,{'link.edit':'[_BUTTONS_]','link.insert':'[_BUTTONS_][_INPUT_LAYER_]'}),a.extend(a.FE.DEFAULTS,{linkEditButtons:['linkOpen','linkStyle','linkEdit','linkRemove'],linkInsertButtons:['linkBack','|','linkList'],linkAttributes:{},linkAutoPrefix:'http://',linkStyles:{'fr-green':'Green','fr-strong':'Thick'},linkMultipleStyles:!0,linkConvertEmailAddress:!0,linkAlwaysBlank:!1,linkAlwaysNoFollow:!1,linkList:[{text:'Froala',href:'https://froala.com',target:'_blank'},{text:'Google',href:'https://google.com',target:'_blank'},{displayText:'Facebook',href:'https://facebook.com'}],linkText:!0}),a.FE.PLUGINS.link=function(b){function d(){var D=b.image?b.image.get():null;if(!D&&b.$wp){var E=b.selection.ranges(0).commonAncestorContainer;if(E&&(E.contains&&E.contains(b.el)||!b.el.contains(E)||b.el==E)&&(E=null),E&&'A'===E.tagName)return E;var F=b.selection.element(),G=b.selection.endElement();return'A'==F.tagName||b.node.isElement(F)||(F=a(F).parentsUntil(b.$el,'a:first').get(0)),'A'==G.tagName||b.node.isElement(G)||(G=a(G).parentsUntil(b.$el,'a:first').get(0)),G&&(G.contains&&G.contains(b.el)||!b.el.contains(G)||b.el==G)&&(G=null),F&&(F.contains&&F.contains(b.el)||!b.el.contains(F)||b.el==F)&&(F=null),G&&G==F&&'A'==G.tagName?F:null}return'A'==b.el.tagName?b.el:D&&D.get(0).parentNode&&'A'==D.get(0).parentNode.tagName?D.get(0).parentNode:void 0}function f(){var D=b.image?b.image.get():null,E=[];if(D)'A'==D.get(0).parentNode.tagName&&E.push(D.get(0).parentNode);else{var F,G,H,I;if(b.win.getSelection){var J=b.win.getSelection();if(J.getRangeAt&&J.rangeCount){I=b.doc.createRange();for(var K=0;K<J.rangeCount;++K)if(F=J.getRangeAt(K),G=F.commonAncestorContainer,G&&1!=G.nodeType&&(G=G.parentNode),G&&'a'==G.nodeName.toLowerCase())E.push(G);else{H=G.getElementsByTagName('a');for(var L=0;L<H.length;++L)I.selectNodeContents(H[L]),1>I.compareBoundaryPoints(F.END_TO_START,F)&&-1<I.compareBoundaryPoints(F.START_TO_END,F)&&E.push(H[L])}}}else if(b.doc.selection&&'Control'!=b.doc.selection.type)if(F=b.doc.selection.createRange(),G=F.parentElement(),'a'==G.nodeName.toLowerCase())E.push(G);else{H=G.getElementsByTagName('a'),I=b.doc.body.createTextRange();for(var M=0;M<H.length;++M)I.moveToElementText(H[M]),-1<I.compareEndPoints('StartToEnd',F)&&1>I.compareEndPoints('EndToStart',F)&&E.push(H[M])}}return E}function g(D){l(),setTimeout(function(){if(!D||D&&(1==D.which||'mouseup'!=D.type)){var E=d(),F=b.image?b.image.get():null;if(E&&!F){if(b.image){var G=b.node.contents(E);if(1==G.length&&'IMG'==G[0].tagName){var H=b.selection.ranges(0);return 0===H.startOffset&&0===H.endOffset?a(E).before(a.FE.MARKERS):a(E).after(a.FE.MARKERS),b.selection.restore(),!1}}D&&D.stopPropagation(),k(E)}}},b.helpers.isIOS()?100:0)}function k(D){var E=b.popups.get('link.edit');E||(E=m());var F=a(D);b.popups.isVisible('link.edit')||b.popups.refresh('link.edit'),b.popups.setContainer('link.edit',b.$sc);var G=F.offset().left+a(D).outerWidth()/2,H=F.offset().top+F.outerHeight();b.popups.show('link.edit',G,H,F.outerHeight())}function l(){b.popups.hide('link.edit')}function m(){var D='';1<b.opts.linkEditButtons.length&&('A'==b.el.tagName&&0<=b.opts.linkEditButtons.indexOf('linkRemove')&&b.opts.linkEditButtons.splice(b.opts.linkEditButtons.indexOf('linkRemove'),1),D='<div class="fr-buttons">'+b.button.buildList(b.opts.linkEditButtons)+'</div>');var E={buttons:D},F=b.popups.create('link.edit',E);return b.$wp&&b.events.$on(b.$wp,'scroll.link-edit',function(){d()&&b.popups.isVisible('link.edit')&&k(d())}),F}function n(){}function o(){var D=b.popups.get('link.insert'),E=d();if(E){var F=a(E),G=D.find('input.fr-link-attr[type="text"]'),H=D.find('input.fr-link-attr[type="checkbox"]'),I,J;for(I=0;I<G.length;I++)J=a(G[I]),J.val(F.attr(J.attr('name')||''));for(H.prop('checked',!1),I=0;I<H.length;I++)J=a(H[I]),F.attr(J.attr('name'))==J.data('checked')&&J.prop('checked',!0);D.find('input.fr-link-attr[type="text"][name="text"]').val(F.text())}else D.find('input.fr-link-attr[type="text"]').val(''),D.find('input.fr-link-attr[type="checkbox"]').prop('checked',!1),D.find('input.fr-link-attr[type="text"][name="text"]').val(b.selection.text());D.find('input.fr-link-attr').trigger('change');var K=b.image?b.image.get():null;K?D.find('.fr-link-attr[name="text"]').parent().hide():D.find('.fr-link-attr[name="text"]').parent().show()}function q(D){if(D)return b.popups.onRefresh('link.insert',o),b.popups.onHide('link.insert',n),!0;var E='';1<=b.opts.linkInsertButtons.length&&(E='<div class="fr-buttons">'+b.button.buildList(b.opts.linkInsertButtons)+'</div>');var G='',H=0;for(var I in G='<div class="fr-link-insert-layer fr-layer fr-active" id="fr-link-insert-layer-'+b.id+'">',G+='<div class="fr-input-line"><input id="fr-link-insert-layer-url-'+b.id+'" name="href" type="text" class="fr-link-attr" placeholder="URL" tabIndex="'+ ++H+'"></div>',b.opts.linkText&&(G+='<div class="fr-input-line"><input id="fr-link-insert-layer-text-'+b.id+'" name="text" type="text" class="fr-link-attr" placeholder="'+b.language.translate('Text')+'" tabIndex="'+ ++H+'"></div>'),b.opts.linkAttributes)if(b.opts.linkAttributes.hasOwnProperty(I)){var J=b.opts.linkAttributes[I];G+='<div class="fr-input-line"><input name="'+I+'" type="text" class="fr-link-attr" placeholder="'+b.language.translate(J)+'" tabIndex="'+ ++H+'"></div>'}b.opts.linkAlwaysBlank||(G+='<div class="fr-checkbox-line"><span class="fr-checkbox"><input name="target" class="fr-link-attr" data-checked="_blank" type="checkbox" id="fr-link-target-'+b.id+'" tabIndex="'+ ++H+'"><span>'+'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="10" height="10" viewBox="0 0 32 32"><path d="M27 4l-15 15-7-7-5 5 12 12 20-20z" fill="#FFF"></path></svg>'+'</span></span><label for="fr-link-target-'+b.id+'">'+b.language.translate('Open in new tab')+'</label></div>'),G+='<div class="fr-action-buttons"><button class="fr-command fr-submit" role="button" data-cmd="linkInsert" href="#" tabIndex="'+ ++H+'" type="button">'+b.language.translate('Insert')+'</button></div></div>';var K={buttons:E,input_layer:G},L=b.popups.create('link.insert',K);return b.$wp&&b.events.$on(b.$wp,'scroll.link-insert',function(){var M=b.image?b.image.get():null;M&&b.popups.isVisible('link.insert')&&B(),d&&b.popups.isVisible('link.insert')&&z()}),L}function x(){if(!b.selection.isCollapsed()){b.selection.save();for(var E,D=b.$el.find('.fr-marker').addClass('fr-unprocessed').toArray();D.length;){E=a(D.pop()),E.removeClass('fr-unprocessed');var F=b.node.deepestParent(E.get(0));if(F){var G=E.get(0),H='',I='';do G=G.parentNode,b.node.isBlock(G)||(H+=b.node.closeTagString(G),I=b.node.openTagString(G)+I);while(G!=F);var J=b.node.openTagString(E.get(0))+E.html()+b.node.closeTagString(E.get(0));E.replaceWith('<span id="fr-break"></span>');var K=a(F).html();K=K.replace(/<span id="fr-break"><\/span>/g,H+J+I),a(F).html(K)}D=b.$el.find('.fr-marker.fr-unprocessed').toArray()}b.selection.restore()}}function y(D,E,F){if('undefined'==typeof F&&(F={}),!1===b.events.trigger('link.beforeInsert',[D,E,F]))return!1;var G=b.image?b.image.get():null;G||'A'==b.el.tagName?'A'==b.el.tagName&&b.$el.focus():(b.selection.restore(),b.popups.hide('link.insert'));var H=D;if(b.opts.linkConvertEmailAddress){var I=/^[\w._]+@[a-z\u00a1-\uffff0-9_-]+?\.[a-z\u00a1-\uffff0-9]{2,}$/i;I.test(D)&&!/^mailto:.*/i.test(D)&&(D='mailto:'+D)}if(''===b.opts.linkAutoPrefix||/^(mailto|tel|sms|notes|data):.*/i.test(D)||/^data:image.*/i.test(D)||/^(https?:|ftps?:|file:|)\/\//i.test(D)||!(0>['/','{','[','#','('].indexOf((D||'')[0]))||(D=b.opts.linkAutoPrefix+D),D=b.helpers.sanitizeURL(D),b.opts.linkAlwaysBlank&&(F.target='_blank'),b.opts.linkAlwaysNoFollow&&(F.rel='nofollow'),'_blank'==F.target&&(F.rel?F.rel+=' noopener noreferrer':F.rel='noopener noreferrer'),E=E||'',D===b.opts.linkAutoPrefix){var J=b.popups.get('link.insert');return J.find('input[name="href"]').addClass('fr-error'),b.events.trigger('link.bad',[H]),!1}var L,K=d();if(K)L=a(K),L.attr('href',D),0<E.length&&L.text()!=E&&!G&&L.text(E),G||L.prepend(a.FE.START_MARKER).append(a.FE.END_MARKER),L.attr(F),G||b.selection.restore();else{G?G.wrap('<a href="'+D+'"></a>'):(b.format.remove('a'),b.selection.isCollapsed()?(E=0===E.length?H:E,b.html.insert('<a href="'+D+'">'+a.FE.START_MARKER+E+a.FE.END_MARKER+'</a>'),b.selection.restore()):0<E.length&&E!=b.selection.text().replace(/\n/g,'')?(b.selection.remove(),b.html.insert('<a href="'+D+'">'+a.FE.START_MARKER+E+a.FE.END_MARKER+'</a>'),b.selection.restore()):(x(),b.format.apply('a',{href:D})));for(var M=f(),N=0;N<M.length;N++)L=a(M[N]),L.attr(F),L.removeAttr('_moz_dirty');1==M.length&&b.$wp&&!G&&(a(M[0]).prepend(a.FE.START_MARKER).append(a.FE.END_MARKER),b.selection.restore())}if(!G)g();else{var O=b.popups.get('link.insert');O.find('input:focus').blur(),b.image.edit(G)}}function z(){l();var D=d();if(D){var E=b.popups.get('link.insert');E||(E=q()),b.popups.isVisible('link.insert')||(b.popups.refresh('link.insert'),b.selection.save(),b.helpers.isMobile()&&(b.events.disableBlur(),b.$el.blur(),b.events.enableBlur())),b.popups.setContainer('link.insert',b.$sc);var F=(b.image?b.image.get():null)||a(D),G=F.offset().left+F.outerWidth()/2,H=F.offset().top+F.outerHeight();b.popups.show('link.insert',G,H,F.outerHeight())}}function B(){var D=b.image?b.image.get():null;if(D){var E=b.popups.get('link.insert');E||(E=q()),o(!0),b.popups.setContainer('link.insert',b.$sc);var F=D.offset().left+D.outerWidth()/2,G=D.offset().top+D.outerHeight();b.popups.show('link.insert',F,G,D.outerHeight())}}return{_init:function(){b.events.on('keyup',function(D){D.which!=a.FE.KEYCODE.ESC&&g(D)}),b.events.on('window.mouseup',g),b.helpers.isMobile()&&b.events.$on(b.$doc,'selectionchange',g),q(!0),'A'==b.el.tagName&&b.$el.addClass('fr-view'),b.events.on('toolbar.esc',function(){if(b.popups.isVisible('link.edit'))return b.events.disableBlur(),b.events.focus(),!1},!0)},remove:function(){var D=d(),E=b.image?b.image.get():null;return!1!==b.events.trigger('link.beforeRemove',[D])&&void(E&&D?(E.unwrap(),b.image.edit(E)):D&&(b.selection.save(),a(D).replaceWith(a(D).html()),b.selection.restore(),l()))},showInsertPopup:function(){var D=b.$tb.find('.fr-command[data-cmd="insertLink"]'),E=b.popups.get('link.insert');if(E||(E=q()),!E.hasClass('fr-active'))if(b.popups.refresh('link.insert'),b.popups.setContainer('link.insert',b.$tb||b.$sc),D.is(':visible')){var F=D.offset().left+D.outerWidth()/2,G=D.offset().top+(b.opts.toolbarBottom?10:D.outerHeight()-10);b.popups.show('link.insert',F,G,D.outerHeight())}else b.position.forSelection(E),b.popups.show('link.insert')},usePredefined:function(D){var E=b.opts.linkList[D],F=b.popups.get('link.insert'),G=F.find('input.fr-link-attr[type="text"]'),H=F.find('input.fr-link-attr[type="checkbox"]'),I,J;for(J=0;J<G.length;J++)I=a(G[J]),E[I.attr('name')]?I.val(E[I.attr('name')]):'text'!=I.attr('name')&&I.val('');for(J=0;J<H.length;J++)I=a(H[J]),I.prop('checked',I.data('checked')==E[I.attr('name')]);b.accessibility.focusPopup(F)},insertCallback:function(){var D=b.popups.get('link.insert'),E=D.find('input.fr-link-attr[type="text"]'),F=D.find('input.fr-link-attr[type="checkbox"]'),G=E.filter('[name="href"]').val(),H=E.filter('[name="text"]').val(),I={},J,K;for(K=0;K<E.length;K++)J=a(E[K]),0>['href','text'].indexOf(J.attr('name'))&&(I[J.attr('name')]=J.val());for(K=0;K<F.length;K++)J=a(F[K]),I[J.attr('name')]=J.is(':checked')?J.data('checked'):J.data('unchecked')||null;var L=b.helpers.scrollTop();y(G,H,I),a(b.o_win).scrollTop(L)},insert:y,update:z,get:d,allSelected:f,back:function(){var D=b.image?b.image.get():null;if(!D){b.events.disableBlur(),b.selection.restore(),b.events.enableBlur();var E=d();E&&b.$wp?(b.selection.restore(),l(),g()):'A'==b.el.tagName?(b.$el.focus(),g()):(b.popups.hide('link.insert'),b.toolbar.showInline())}else b.image.back()},imageLink:B,applyStyle:function(D,E,F){'undefined'==typeof F&&(F=b.opts.linkMultipleStyles),'undefined'==typeof E&&(E=b.opts.linkStyles);var G=d();if(!G)return!1;if(!F){var H=Object.keys(E);H.splice(H.indexOf(D),1),a(G).removeClass(H.join(' '))}a(G).toggleClass(D),g()}}},a.FE.DefineIcon('insertLink',{NAME:'link'}),a.FE.RegisterShortcut(a.FE.KEYCODE.K,'insertLink',null,'K'),a.FE.RegisterCommand('insertLink',{title:'Insert Link',undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible('link.insert')?(this.$el.find('.fr-marker').length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide('link.insert')):this.link.showInsertPopup()},plugin:'link'}),a.FE.DefineIcon('linkOpen',{NAME:'external-link'}),a.FE.RegisterCommand('linkOpen',{title:'Open Link',undo:!1,refresh:function(b){var d=this.link.get();d?b.removeClass('fr-hidden'):b.addClass('fr-hidden')},callback:function(){var b=this.link.get();b&&this.o_win.open(b.href)}}),a.FE.DefineIcon('linkEdit',{NAME:'edit'}),a.FE.RegisterCommand('linkEdit',{title:'Edit Link',undo:!1,refreshAfterCallback:!1,popup:!0,callback:function(){this.link.update()},refresh:function(b){var d=this.link.get();d?b.removeClass('fr-hidden'):b.addClass('fr-hidden')}}),a.FE.DefineIcon('linkRemove',{NAME:'unlink'}),a.FE.RegisterCommand('linkRemove',{title:'Unlink',callback:function(){this.link.remove()},refresh:function(b){var d=this.link.get();d?b.removeClass('fr-hidden'):b.addClass('fr-hidden')}}),a.FE.DefineIcon('linkBack',{NAME:'arrow-left'}),a.FE.RegisterCommand('linkBack',{title:'Back',undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.link.back()},refresh:function(b){var d=this.link.get()&&this.doc.hasFocus(),f=this.image?this.image.get():null;f||d||this.opts.toolbarInline?(b.removeClass('fr-hidden'),b.next('.fr-separator').removeClass('fr-hidden')):(b.addClass('fr-hidden'),b.next('.fr-separator').addClass('fr-hidden'))}}),a.FE.DefineIcon('linkList',{NAME:'search'}),a.FE.RegisterCommand('linkList',{title:'Choose Link',type:'dropdown',focus:!1,undo:!1,refreshAfterCallback:!1,html:function(){for(var b='<ul class="fr-dropdown-list" role="presentation">',d=this.opts.linkList,f=0;f<d.length;f++)b+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="linkList" data-param1="'+f+'">'+(d[f].displayText||d[f].text)+'</a></li>';return b+='</ul>',b},callback:function(b,d){this.link.usePredefined(d)}}),a.FE.RegisterCommand('linkInsert',{focus:!1,refreshAfterCallback:!1,callback:function(){this.link.insertCallback()},refresh:function(b){var d=this.link.get();d?b.text(this.language.translate('Update')):b.text(this.language.translate('Insert'))}}),a.FE.DefineIcon('imageLink',{NAME:'link'}),a.FE.RegisterCommand('imageLink',{title:'Insert Link',undo:!1,focus:!1,popup:!0,callback:function(){this.link.imageLink()},refresh:function(b){var d=this.link.get(),f;d?(f=b.prev(),f.hasClass('fr-separator')&&f.removeClass('fr-hidden'),b.addClass('fr-hidden')):(f=b.prev(),f.hasClass('fr-separator')&&f.addClass('fr-hidden'),b.removeClass('fr-hidden'))}}),a.FE.DefineIcon('linkStyle',{NAME:'magic'}),a.FE.RegisterCommand('linkStyle',{title:'Style',type:'dropdown',html:function(){var b='<ul class="fr-dropdown-list" role="presentation">',d=this.opts.linkStyles;for(var f in d)d.hasOwnProperty(f)&&(b+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="linkStyle" data-param1="'+f+'">'+this.language.translate(d[f])+'</a></li>');return b+='</ul>',b},callback:function(b,d){this.link.applyStyle(d)},refreshOnShow:function(b,d){var f=this.link.get();if(f){var g=a(f);d.find('.fr-command').each(function(){var k=a(this).data('param1'),l=g.hasClass(k);a(this).toggleClass('fr-active',l).attr('aria-selected',l)})}}})});