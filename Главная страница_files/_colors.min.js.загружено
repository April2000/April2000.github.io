(function(a){a(jQuery)})(function(a){a.extend(a.FE.POPUP_TEMPLATES,{'colors.picker':'[_BUTTONS_][_TEXT_COLORS_][_BACKGROUND_COLORS_]'}),a.extend(a.FE.DEFAULTS,{colorsText:['#61BD6D','#1ABC9C','#54ACD2','#2C82C9','#9365B8','#475577','#CCCCCC','#41A85F','#00A885','#3D8EB9','#2969B0','#553982','#28324E','#000000','#F7DA64','#FBA026','#EB6B56','#E25041','#A38F84','#EFEFEF','#FFFFFF','#FAC51C','#F37934','#D14841','#B8312F','#7C706B','#D1D5D8','REMOVE'],colorsBackground:['#61BD6D','#1ABC9C','#54ACD2','#2C82C9','#9365B8','#475577','#CCCCCC','#41A85F','#00A885','#3D8EB9','#2969B0','#553982','#28324E','#000000','#F7DA64','#FBA026','#EB6B56','#E25041','#A38F84','#EFEFEF','#FFFFFF','#FAC51C','#F37934','#D14841','#B8312F','#7C706B','#D1D5D8','REMOVE'],colorsStep:7,colorsDefaultTab:'text',colorsButtons:['colorsBack','|','-']}),a.FE.PLUGINS.colors=function(b){function d(){b.popups.hide('colors.picker')}function f(){var p='<div class="fr-buttons fr-colors-buttons">';b.opts.toolbarInline&&0<b.opts.colorsButtons.length&&(p+=b.button.buildList(b.opts.colorsButtons)),p+=g()+'</div>';var q={buttons:p,text_colors:h('text'),background_colors:h('background')},r=b.popups.create('colors.picker',q);return j(r),r}function g(){var p='<div class="fr-colors-tabs fr-group'+(b.opts.colorsText&&b.opts.colorsBackground?'':' disabled')+'">';return b.opts.colorsText&&(p+='<span class="fr-colors-tab '+('background'==b.opts.colorsDefaultTab?'':'fr-selected-tab ')+'fr-command" tabIndex="-1" role="button" aria-pressed="'+('background'!=b.opts.colorsDefaultTab)+'" data-param1="text" data-cmd="colorChangeSet" title="'+b.language.translate('Text')+'">'+b.language.translate('Text')+'</span>'),b.opts.colorsBackground&&(p+='<span class="fr-colors-tab '+('background'==b.opts.colorsDefaultTab?'fr-selected-tab ':'')+'fr-command" tabIndex="-1" role="button" aria-pressed="'+('background'==b.opts.colorsDefaultTab)+'" data-param1="background" data-cmd="colorChangeSet" title="'+b.language.translate('Background')+'">'+b.language.translate('Background')+'</span>'),p+'</div>'}function h(p){for(var q='text'==p?b.opts.colorsText:b.opts.colorsBackground,r='<div class="fr-color-set fr-'+p+'-color'+(b.opts.colorsDefaultTab==p||'text'!=b.opts.colorsDefaultTab&&'background'!=b.opts.colorsDefaultTab&&'text'==p?' fr-selected-set':'')+'">',s=0;s<q.length;s++)0!==s&&0==s%b.opts.colorsStep&&(r+='<br>'),r+='REMOVE'==q[s]?'<span class="fr-command fr-select-color" data-cmd="'+p+'Color" tabIndex="-1" role="button" data-param1="REMOVE" title="'+b.language.translate('Clear Formatting')+'">'+b.icon.create('remove')+'<span class="fr-sr-only">'+b.language.translate('Clear Formatting')+'</span></span>':'<span class="fr-command fr-select-color" style="background: '+q[s]+';" tabIndex="-1" aria-selected="false" role="button" data-cmd="'+p+'Color" data-param1="'+q[s]+'"><span class="fr-sr-only">'+b.language.translate('Color')+' '+q[s]+'&nbsp;&nbsp;&nbsp;</span></span>';return r+'</div>'}function j(p){b.events.on('popup.tab',function(q){var r=a(q.currentTarget);if(!b.popups.isVisible('colors.picker')||!r.is('span'))return!0;var s=q.which,t=!0;if(a.FE.KEYCODE.TAB==s){var u=p.find('.fr-buttons');t=!b.accessibility.focusToolbar(u,!!q.shiftKey)}else if(a.FE.KEYCODE.ARROW_UP!=s&&a.FE.KEYCODE.ARROW_DOWN!=s&&a.FE.KEYCODE.ARROW_LEFT!=s&&a.FE.KEYCODE.ARROW_RIGHT!=s)a.FE.KEYCODE.ENTER==s&&(b.button.exec(r),t=!1);else if(r.is('span.fr-select-color')){var v=r.parent().find('span.fr-select-color'),w=v.index(r),x=b.opts.colorsStep,y=Math.floor(v.length/x),A=Math.floor(w/x),B=A*x+w%x,C=y*x;a.FE.KEYCODE.ARROW_UP==s?B=((B-x)%C+C)%C:a.FE.KEYCODE.ARROW_DOWN==s?B=(B+x)%C:a.FE.KEYCODE.ARROW_LEFT==s?B=((B-1)%C+C)%C:a.FE.KEYCODE.ARROW_RIGHT==s&&(B=(B+1)%C);var D=a(v.get(B));b.events.disableBlur(),D.focus(),t=!1}return!1==t&&(q.preventDefault(),q.stopPropagation()),t},!0)}function k(p){var q=b.popups.get('colors.picker'),r=a(b.selection.element()),s;s='background'==p?'background-color':'color';var t=q.find('.fr-'+p+'-color .fr-select-color');for(t.find('.fr-selected-color').remove(),t.removeClass('fr-active-item'),t.not('[data-param1="REMOVE"]').attr('aria-selected',!1);r.get(0)!=b.el;)if('transparent'==r.css(s)||'rgba(0, 0, 0, 0)'==r.css(s))r=r.parent();else{var u=q.find('.fr-'+p+'-color .fr-select-color[data-param1="'+b.helpers.RGBToHex(r.css(s))+'"]');u.append('<span class="fr-selected-color" aria-hidden="true"></span>'),u.addClass('fr-active-item').attr('aria-selected',!0);break}}return{showColorsPopup:function(){var p=b.$tb.find('.fr-command[data-cmd="color"]'),q=b.popups.get('colors.picker');if(q||(q=f()),!q.hasClass('fr-active'))if(b.popups.setContainer('colors.picker',b.$tb),k(q.find('.fr-selected-tab').attr('data-param1')),p.is(':visible')){var r=q.closest('.container-list, .modal-list, .widget-list').eq(0),s=p.offset().left+p.outerWidth()/2,t=p.offset().top+(b.opts.toolbarBottom?10:p.outerHeight()-10),u=t+q.outerHeight(!0)>r.outerHeight();q.toggleClass('show-in-top',u),b.popups.show('colors.picker',s,t,p.outerHeight())}else b.position.forSelection(q),b.popups.show('colors.picker')},hideColorsPopup:d,changeSet:function(p,q){p.hasClass('fr-selected-tab')||(p.siblings().removeClass('fr-selected-tab').attr('aria-pressed',!1),p.addClass('fr-selected-tab').attr('aria-pressed',!0),p.parents('.fr-popup').find('.fr-color-set').removeClass('fr-selected-set'),p.parents('.fr-popup').find('.fr-color-set.fr-'+q+'-color').addClass('fr-selected-set'),k(q)),b.accessibility.focusPopup(p.parents('.fr-popup'))},background:function(p){'REMOVE'==p?b.format.removeStyle('background-color'):b.format.applyStyle('background-color',b.helpers.HEXtoRGB(p)),d()},text:function(p){b.selection.text()||b.doc.execCommand('selectAll',!1,!1),'REMOVE'==p?b.format.removeStyle('color'):b.format.applyStyle('color',b.helpers.HEXtoRGB(p)),d()},back:function(){b.popups.hide('colors.picker'),b.toolbar.showInline()}}},a.FE.DefineIcon('colors',{NAME:'tint'}),a.FE.RegisterCommand('color',{title:'Colors',undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible('colors.picker')?(this.$el.find('.fr-marker').length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide('colors.picker')):this.colors.showColorsPopup()},plugin:'colors'}),a.FE.RegisterCommand('textColor',{undo:!0,callback:function(b,c){this.colors.text(c)}}),a.FE.RegisterCommand('backgroundColor',{undo:!0,callback:function(b,c){this.colors.background(c)}}),a.FE.RegisterCommand('colorChangeSet',{undo:!1,focus:!1,callback:function(b,c){var d=this.popups.get('colors.picker').find('.fr-command[data-cmd="'+b+'"][data-param1="'+c+'"]');this.colors.changeSet(d,c)}}),a.FE.DefineIcon('colorsBack',{NAME:'arrow-left'}),a.FE.RegisterCommand('colorsBack',{title:'Back',undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.colors.back()}}),a.FE.DefineIcon('remove',{NAME:'eraser'})});