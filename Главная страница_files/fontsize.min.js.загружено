(function(a){a.extend(a.FroalaEditor.POPUP_TEMPLATES,{'fontSize.popup':'[_BUTTONS_][_CUSTOM_LAYER_]'}),a.extend(a.FroalaEditor.DEFAULTS,{fontSizeButtons:['fontSizeBack'],fontSizeMin:50,fontSizeMax:200,fontSizeStep:1}),a.FroalaEditor.PLUGINS.fontSize=function(b){function c(j){return parseFloat(j.css('font-size'))}function d(j){var k=a(j),l=c(k),m=c(k.closest('[data-editor]')),n=parseInt(100*(l/m));return[n,l,m]}function e(j){var k=b.popups.get('fontSize.popup'),l=k.data('initialFontSuze');clearTimeout(i),i=setTimeout(function(){b.selection.restore(),b.format.applyStyle('font-size',j.target.valueAsNumber/100+'em'),b.selection.save(),b.events.trigger('contentChanged')},b.browser.mozilla?150:0),a('.font-size .value.percent',k).text(j.target.valueAsNumber),a('.font-size .value.px',k).text(parseInt(l*j.target.valueAsNumber/100,10))}function f(){var j='';b.opts.fontSizeButtons.length&&(j='<div class="font-size-title"><div class="fr-buttons">'+b.button.buildList(b.opts.fontSizeButtons)+'</div><div class="font-size"><span class="value px"></span>px <span class="value percent"></span>%</div></div>');var k={buttons:j,custom_layer:'<div class="font-size-content"><input type="range" step="'+b.opts.fontSizeStep+'" min="'+b.opts.fontSizeMin+'" max="'+b.opts.fontSizeMax+'"></div>'},l=b.popups.create('fontSize.popup',k);return a('input',l).on('input',e),l}var i;return{initPopup:f,showPopup:function(){var j=b.popups.get('fontSize.popup'),k=d(b.selection.element());if(j||(j=f()),!j.hasClass('fr-active')){var l=a('input',j);l.val(k[0]),b.selection.text()||b.doc.execCommand('selectAll',!1,!1),j.data('initialFontSuze',k[2]),a('.font-size .value.percent',j).text(k[0]),a('.font-size .value.px',j).text(parseInt(k[1],10)),b.popups.setContainer('fontSize.popup',b.$tb),b.position.forSelection(j),b.popups.show('fontSize.popup'),b.selection.save()}},hidePopup:function(){b.popups.hide('fontSize.popup'),b.toolbar.showInline()}}},a.FroalaEditor.RegisterCommand('fontSize',{title:'Font Size',icon:'fontSize',undo:!0,focus:!0,popup:!0,refreshOnCallback:!1,plugin:'fontSize',callback:function(){this.fontSize.showPopup()}}),a.FE.RegisterCommand('fontSizeBack',{title:'Back',undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.fontSize.hidePopup()}})})(jQuery);